class GameBoard{constructor(t){this.canvas=document.getElementById(t),this.games=[new GameOfLife,new MazeGen],this.active_game=0,this.fps=20}empty_frame(){let t="\u2554",e=" Error?!  ",s=16-e.length/2;for(let e=0;e<s;e++)t+="\u2550";t+=e;for(let e=0;e<s;e++)t+="\u2550";t+="\u2557\n";for(let e=0;e<32;e+=2){t+="\u2551";for(let e=0;e<32;e++)t+=" ";t+="\u2551\n"}t+="\u255a";for(let e=0;e<32;e++)t+="\u2550";return t+="\u255d",t}start(){this.canvas.addEventListener("click",t=>{let e=t.target.getBoundingClientRect(),s=t.clientX-e.left,i=t.clientY-e.top;s=Math.floor(s/e.width*34)-1,i=Math.floor(i/e.height*34)-1,this.games[this.active_game]&&this.games[this.active_game].onclick(s,i,"left")}),this.canvas.addEventListener("contextmenu",t=>{let e=t.target.getBoundingClientRect(),s=t.clientX-e.left,i=t.clientY-e.top;s=Math.floor(s/e.width*34)-1,i=Math.floor(i/e.height*34)-1,this.games[this.active_game]&&this.games[this.active_game].onclick(s,i,"right")}),document.body.addEventListener("keydown",t=>{this.games[this.active_game]&&this.games[this.active_game].onkeydown(t)});let t=this,e=function(){t.games[t.active_game]?(t.games[t.active_game].onupdate(),t.canvas.innerText=t.games[t.active_game].draw()):t.canvas.innerText=t.empty_frame(),window.setTimeout(e,1e3/t.fps)};window.setTimeout(e,1e3/this.fps)}}class Game{constructor(){this.run=!0}onclick(t,e,s){}onkeydown(t){}onupdate(t){}draw(){}}class GameOfLife extends Game{constructor(){super(),this.grid_raw=[];for(let t=0;t<32;t++){let t=[];for(let e=0;e<32;e++)t.push(0);this.grid_raw.push(t)}this.run=!0,this.won=!1,this.lookup=[[],[]],this.lookup[0][0]=".",this.lookup[1][0]="\u2580",this.lookup[0][1]="\u2584",this.lookup[1][1]="\u2588",this.randomize()}onclick(t,e,s){if("left"==s){if(t<32&&e<32&&(this.grid_raw[e][t]=0==this.grid_raw[e][t]?1:0),32==e){let e=this.run?" Stop ":" Start ",s=16-e.length/2;s-=e.length%2;let i=1+s;t>i&&t<i+e.length&&(this.run=!this.run)}}else"right"==s&&t<32&&e<32&&this.spawn_lwss(t,e)}randomize(){for(let t=0;t<32;t++)for(let e=0;e<32;e++)this.grid_raw[t][e]=Math.random()<.5?0:1}spawn_lwss(t,e){t=t%32<0?32+t%32:t%32,e=e%32<0?32+e%32:e%32,this.grid_raw[e][t]=1,this.grid_raw[e+1][t+1]=1,this.grid_raw[e+1][t+2]=1,this.grid_raw[e][t+2]=1,this.grid_raw[e-1][t+2]=1}onupdate(t){if(!this.run)return;let e=!1,s=this.grid_raw.map(t=>({...t})),i=0;for(let t=0;t<32;t++)for(let h=0;h<32;h++){let a=0,r=t=>t%32<0?32+t%32:t%32,l=t=>t%32<0?32+t%32:t%32;a+=this.grid_raw[r(t-1)][l(h-1)],a+=this.grid_raw[r(t-1)][l(h)],a+=this.grid_raw[r(t-1)][l(h+1)],a+=this.grid_raw[r(t)][l(h-1)],a+=this.grid_raw[r(t)][l(h)],a+=this.grid_raw[r(t)][l(h+1)],a+=this.grid_raw[r(t+1)][l(h-1)],a+=this.grid_raw[r(t+1)][l(h)],a+=this.grid_raw[r(t+1)][l(h+1)];let n=s[t][h];3==a?s[t][h]=1:4!=a&&(s[t][h]=0),i+=a,s[t][h]!=n&&(e=!0)}return 0==i?(e=!0,window.setTimeout(()=>{board.active_game=1},2e4),this.won=!0):this.won=!1,this.grid_raw=s,e}draw(){let t="\u2554",e=this.won?" Congratulations! ":" The Game of Life ",s=16-e.length/2;for(let e=0;e<s;e++)t+="\u2550";t+=e;for(let e=0;e<s;e++)t+="\u2550";t+="\u2557\n";for(let e=0;e<32;e+=2){t+="\u2551";for(let s=0;s<32;s++)this.won?t+=e/2%2==1&&e<30?"You win!  "[(s+(this.run?run_time:0)+10+e/2)%10]:" ":t+=this.lookup[this.grid_raw[e][s]][this.grid_raw[e+1][s]];t+="\u2551\n"}let i=this.run?" Stop ":" Start ";s=16-i.length/2,s-=i.length%2,t+="\u255a";for(let e=0;e<s;e++)t+="\u2550";t+=i;for(let e=0;e<s+i.length%2;e++)t+="\u2550";return t+="\u255d",t}}class MazeGen extends Game{constructor(){super(),this.maze=[];for(let t=0;t<8;t++){let t=[];for(let e=0;e<16;e++)t.push({north:!0,south:!0,east:!0,west:!0,visited:!1});this.maze.push(t)}this.generate=!0;let t={x:3,y:3};this.maze[t.y][t.x].visited=!0,this.stack=[t],this.ticker=0,this.player_x=0,this.player_y=0,this.path=[],this.delta=-1,this.won=!1,this.win_time=0}onkeydown(t){this.generate||this.won||("w"==t.key?this.player_y>0&&(this.maze[this.player_y][this.player_x].north||(this.path.push({x:this.player_x,y:this.player_y}),this.player_y-=1)):"s"==t.key?this.player_y+1<8&&(this.maze[this.player_y][this.player_x].south||(this.path.push({x:this.player_x,y:this.player_y}),this.player_y+=1)):"d"==t.key?this.player_x+1<16?this.maze[this.player_y][this.player_x].east||(this.path.push({x:this.player_x,y:this.player_y}),this.player_x+=1):7==this.player_y&&(this.won=!0,this.win_time=run_time):"a"==t.key&&this.player_x>0&&(this.maze[this.player_y][this.player_x].west||(this.path.push({x:this.player_x,y:this.player_y}),this.player_x-=1)))}onupdate(){function t(t){for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}}if(this.generate)if(this.stack.length>0){let e=this.stack.pop(),s=[];e.x+1<16&&s.push({x:e.x+1,y:e.y,dir:"east"}),e.x-1>=0&&s.push({x:e.x-1,y:e.y,dir:"west"}),e.y+1<8&&s.push({x:e.x,y:e.y+1,dir:"south"}),e.y-1>=0&&s.push({x:e.x,y:e.y-1,dir:"north"}),t(s),s=s.filter(t=>!this.maze[t.y][t.x].visited),s.length>0&&(this.stack.push(e),this.stack.push(s[0]),"east"==s[0].dir?(this.maze[e.y][e.x].east=!1,this.maze[e.y][e.x+1].west=!1):"west"==s[0].dir?(this.maze[e.y][e.x].west=!1,this.maze[e.y][e.x-1].east=!1):"north"==s[0].dir?(this.maze[e.y][e.x].north=!1,this.maze[e.y-1][e.x].south=!1):"south"==s[0].dir&&(this.maze[e.y][e.x].south=!1,this.maze[e.y+1][e.x].north=!1),this.maze[s[0].y][s[0].x].visited=!0)}else this.maze[7][15].east=!1,this.ticker=0,this.generate=!1;if(this.won){let t=this.path[this.path.length-1-this.ticker%this.path.length];this.player_x=t.x,this.player_y=t.y,this.ticker+=1,this.maze[this.player_y][this.player_x].char="!niw uoYYou Win!"[this.ticker%8]}}draw(){let t="",e=this.generate?" Maze Generating  ":this.won?"You Win!":"Maze Generator",s=16-e.length/2;for(let e=0;e<s;e++)t+=" ";t+=e;for(let e=0;e<s;e++)t+=" ";t+="\n\u250c";let i={north:!1,south:!1,east:!1,west:!1};for(let e=0;e<16;e++)15!=e?this.maze[0][e].east?t+="\u2500\u252c":t+="\u2500\u2500":t+="\u2500\u2510";t+="\n";let h=[];h[1]="\u2574",h[2]="\u2577",h[4]="\u2576",h[8]="\u2575",h[3]="\u2510",h[6]="\u250c",h[12]="\u2514",h[9]="\u2518",h[10]="\u2502",h[5]="\u2500",h[7]="\u252c",h[11]="\u2524",h[13]="\u2534",h[14]="\u251c",h[15]="\u253c",h[0]=" ";for(let e=0;e<8;e++){let s="",a="";for(let t=0;t<16;t++){this.generate?this.stack.length>0&&e==this.stack[this.stack.length-1].y&&t==this.stack[this.stack.length-1].x?s+=this.ticker%2==0?"/":"\\":s+=" ":this.won&&this.maze[e][t].char?s+=this.maze[e][t].char:this.player_x==t&&this.player_y==e?s+="P":s+=" ",this.maze[e][t].east?s+="\u2502":s+=" ";let r=(this.maze[e][t].east?1:0)<<3|((this.maze[e][t+1]||i).south?1:0)<<2|(e+1<8&&this.maze[e+1][t].east?1:0)<<1|(this.maze[e][t].south?1:0);a+=(this.maze[e][t].south?"\u2500":" ")+h[r]}let r=h[8|(this.maze[e][0].south?1:0)<<2|(7!=e?1:0)<<1];t+=(this.maze[e][0].west?"|":" ")+s+"\n"+r+a+"\n"}return this.generate&&(this.ticker+=1),t}onclick(t,e,s){this.generate||this.won||(e<this.player_y?this.player_y>0&&(this.maze[this.player_y][this.player_x].north||(this.path.push({x:this.player_x,y:this.player_y}),this.player_y-=1)):e>this.player_y&&this.player_y+1<8&&(this.maze[this.player_y][this.player_x].south||(this.path.push({x:this.player_x,y:this.player_y}),this.player_y+=1)),t>this.player_x?this.player_x+1<16?this.maze[this.player_y][this.player_x].east||(this.path.push({x:this.player_x,y:this.player_y}),this.player_x+=1):7==this.player_y&&(this.won=!0,this.win_time=run_time):t<this.player_x&&this.player_x>0&&(this.maze[this.player_y][this.player_x].west||(this.path.push({x:this.player_x,y:this.player_y}),this.player_x-=1)))}}let run_time=0,board=new GameBoard("vertex_gol");board.fps=20,board.start(),window.setInterval(()=>{run_time+=1},1e3);